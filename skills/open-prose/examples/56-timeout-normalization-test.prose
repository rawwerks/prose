# Timeout Normalization Test
# Tests that timeouts correctly trigger on_reject

# Test 1: Short timeout with throw
# DO NOT RESPOND - let this timeout to test the behavior

try:
  gate timeout_throw_test:
    prompt: "DO NOT RESPOND - let this timeout (30 seconds)"
    timeout: "30s"
    on_reject: throw "Timeout test passed: gate timed out and threw"

  session "This should NOT run - gate should have timed out"
catch as err:
  session "Caught timeout error - test 1 passed"
    context: err

# Test 2: Timeout with continue
# DO NOT RESPOND - should continue after timeout

gate timeout_continue_test:
  prompt: "DO NOT RESPOND - let this timeout (30 seconds)"
  timeout: "30s"
  on_reject: continue

session "Execution continued after timeout - test 2 passed"

# Test 3: Timeout with session handler
# DO NOT RESPOND - should trigger fallback session

gate timeout_session_test:
  prompt: "DO NOT RESPOND - let this timeout (30 seconds)"
  timeout: "30s"
  on_reject: session "Timeout handler: gate expired without response"

session "Continuing after timeout was handled - test 3 passed"

# Test 4: Different timeout formats
# Verify various duration formats are parsed correctly

# Note: These are just syntax examples - actual timeout behavior
# depends on the test runner

gate timeout_seconds:
  prompt: "30 second timeout format test"
  timeout: "30s"
  on_reject: continue

gate timeout_minutes:
  prompt: "5 minute timeout format test"
  timeout: "5m"
  on_reject: continue

gate timeout_hours:
  prompt: "1 hour timeout format test"
  timeout: "1h"
  on_reject: continue

session "All timeout format tests complete"
